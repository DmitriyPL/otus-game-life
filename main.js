!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(){function i(e,t,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n(this,"state",[]),n(this,"aliveCells",0),n(this,"stateChanged",!1),n(this,"canvasX",0),n(this,"canvasY",0),this.canvas=e,this.fieldSizeX=t,this.fieldSizeY=a,this.cellSize=r,this.ctx=this.canvas.getContext("2d")}var a,r;return a=i,r=[{key:"setup",value:function(){this.canvas.width=this.fieldSizeX*this.cellSize,this.canvas.height=this.fieldSizeY*this.cellSize,this.canvasX=this.canvas.offsetLeft+this.canvas.clientLeft,this.canvasY=this.canvas.offsetTop+this.canvas.clientTop,this.canvas.addEventListener("click",this.clickHandler.bind(this))}},{key:"getAliveCells",value:function(){return this.aliveCells}},{key:"init",value:function(e){for(var t=0;t<this.fieldSizeY;t+=1)for(var n=0;n<this.fieldSizeX;n+=1)this.state.push(new e(n,t,this.cellSize,"dead"))}},{key:"clickHandler",value:function(t){var n,i=t.pageX-this.canvasX,a=t.pageY-this.canvasY,r=function(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var e=i.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}(this.state);try{for(r.s();!(n=r.n()).done;){var s=n.value,o=s.getCoord("x"),l=s.getCoord("y"),c=s.getSize();if(a>l&&a<l+c&&i>o&&i<o+c){"dead"===s.getType()?(s.setType("alive"),this.aliveCells+=1):(s.setType("dead"),this.aliveCells-=1),this.draw();break}}}catch(e){r.e(e)}finally{r.f()}}},{key:"draw",value:function(){var e=this;this.state.forEach((function(t){var n=t.getCoord("x"),i=t.getCoord("y"),a=t.getSize();"dead"===t.getType()?(e.ctx.clearRect(n,i,a,a),e.ctx.strokeRect(n,i,a,a)):e.ctx.fillRect(n,i,a,a)}))}},{key:"changeState",value:function(){var e=this;this.stateChanged=!1,this.state.forEach((function(t){var n=t.getX(),i=t.getY(),a=e.getAliveNeighbours(n,i);"dead"===t.getType()&&3===a?(t.setNextType("alive"),e.aliveCells+=1,e.stateChanged=!0):"alive"===t.getType()&&(a<2||a>3)&&(t.setNextType("dead"),e.aliveCells-=1,e.stateChanged=!0)})),this.draw(),this.state.forEach((function(e){var t=e.getType(),n=e.getNextType();n!==t&&""!==n&&e.setType(n)}))}},{key:"getAliveNeighbours",value:function(e,t){for(var n=0,i=0,a=[[e-1,t-1],[e-1,t],[e-1,t+1],[e,t-1],[e,t+1],[e+1,t-1],[e+1,t],[e+1,t+1]];i<a.length;i++){var r=a[i],s=r[0],o=r[1];"alive"===this.getNeighbourType(s,o)&&(n+=1)}return n}},{key:"getNeighbourType",value:function(e,t){return e<0||e>this.fieldSizeX-1||t<0||t>this.fieldSizeY-1?"dead":this.state.find((function(n){return n.getX()===e&&n.getY()===t})).getType()}},{key:"clear",value:function(){this.state.forEach((function(e){e.setType("dead"),e.setNextType("")})),this.draw()}},{key:"getStateChanged",value:function(){return this.stateChanged}}],r&&t(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),i}();function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(t,n,i,a){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(r="nextType")in this?Object.defineProperty(this,r,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[r]="",this.x=t,this.y=n,this.size=i,this.type=a}var t,n;return t=e,(n=[{key:"setType",value:function(e){this.type=e}},{key:"getType",value:function(){return this.type}},{key:"getNextType",value:function(){return this.nextType}},{key:"setNextType",value:function(e){this.nextType=e}},{key:"getCoord",value:function(e){return this[e]*this.size}},{key:"getSize",value:function(){return this.size}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();!function(){localStorage.setItem("stopGame","false");var e=document.getElementById("game-field"),t=new i(e,50,50,15);t.setup(),t.init(r),t.draw(),document.getElementById("do-step").addEventListener("click",t.changeState.bind(t)),document.getElementById("clear-field").addEventListener("click",t.clear.bind(t)),document.getElementById("start-game").addEventListener("click",(function(){!function(e){localStorage.setItem("stopGame","false");var t=setInterval((function(){e.changeState(),!1!==e.getStateChanged()&&"true"!==localStorage.getItem("stopGame")||clearInterval(t)}),100)}(t)})),document.getElementById("stop-game").addEventListener("click",(function(){localStorage.setItem("stopGame","true")}))}()}();